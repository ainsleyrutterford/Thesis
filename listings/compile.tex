\begin{lstlisting}[float={ht},caption={A simple example of compiling a Keras model using the \texttt{TensorBoard}, \texttt{EarlyStopping}, and \texttt{ModelCheckpoint} callbacks. The Keras implementations of the Adam optimiser, binary cross-entropy loss, and per-pixel accuracy are used. Once the model is compiled, it is then trained for 20 epochs using the \texttt{fit\_generator} method.},label={lst:compile},language=Python,upquote=true]
from keras.callbacks import TensorBoard, ModelCheckpoint, EarlyStopping
from keras.models import Model
from keras.optimizers import Adam

# Create an instance of the Model class using the Model constructor
model = Model(inputs=..., outputs=...)

# Compile the model using the compile method
model.compile(optimizer=Adam(lr=1e-4), 
              loss="binary_crossentropy",
              metrics=["accuracy"])

# Create a TensorBoard callback
tb = TensorBoard(log_dir="logs/")

# Create an EarlyStopping callback
es = EarlyStopping(monitor="val_loss", mode="min", patience=5)

# Create a ModelCheckpoint callback
mc = ModelCheckpoint(filepath="checkpoint-{epoch:02d}.hdf5",
                     monitor="loss",
                     save_best_only=False)

# Train the model using data provided by the train_generator defined earlier
model.fit_generator(train_generator, 
                    steps_per_epoch=500, 
                    epochs=20,
                    validation_data=val_generator,
                    validation_steps=10,
                    callbacks=[tb, mc, es])
\end{lstlisting}